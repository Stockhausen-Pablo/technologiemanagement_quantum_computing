---
title: "Quantum Computing - Technologiemanagement"
author: "Pablo Stockhausen"
date: "4 6 2022"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

# 0. Install & import packages

### Install

```{r}
#install.packages("tibble")
#install.packages("dplyr")
#install.packages("tidyr")
#install.packages("igraph")
#install.packages("qgraph")
```

### Import

```{r, warning=FALSE, message=FALSE}
library("tibble")
library("dplyr")
library("tidyr")
library("igraph")
library("qgraph")
library("visNetwork")
```


# 1. Data collection

Data set is given and contains patents regarding quantum computing.

Import data:
```{r}
df_qc <- read.csv("Quantum computing.csv", sep=";")
```

# 2. Data cleaning and mapping

Check if data set is in correct format
```{r}
df_qc <- tibble(df_qc)
```

Clean Data
```{r}
df_qc <- df_qc %>% 
  mutate(Inventors=strsplit(Inventors, "\n")) %>% 
  unnest(Inventors)

df_industry_qc <- df_qc %>%
  mutate(Applicants=strsplit(Applicants, "\n")) %>% 
  unnest(Applicants)
```

### Metrics

edge list
```{r}
edge_list <- df_qc %>%
  select(Inventors, Title, Applicants, No) %>%
  inner_join(., select(., Inventors, No), by="No") %>%
  filter(Inventors.x != Inventors.y) %>%
  unique %>%
  arrange(Title, No)

# replace blanks with _
edge_list$Inventors.x <- gsub(" ", "_", edge_list$Inventors.x)
edge_list$Inventors.y <- gsub(" ", "_", edge_list$Inventors.y)
edge_list$Applicants <- gsub(" ", "_", edge_list$Applicants)
```

edge matrix
```{r}
unique_nodes <- unique(c(edge_list$Inventors.x, edge_list$Inventors.y))
edges_length <- length(unique_nodes)

edge_matrix <- matrix(, nrow = edges_length, ncol = edges_length, dimnames = list(unique_nodes, unique_nodes))

edge_matrix[is.na(edge_matrix)] = 0

for(i in 1:edges_length) {
  prim_inventor <- edge_list[[i,"Inventors.x"]]
  sec_inventor <- edge_list[[i,"Inventors.y"]]
  edge_matrix[prim_inventor,sec_inventor] <- edge_matrix[prim_inventor,sec_inventor] + 1 
}

```

Transform edge matrix into adjmatrix
```{r}
adj_matrix <- graph.adjacency(edge_matrix, mode = "undirected")
```


# 3. Network visualization

plot graph based on edge matrix
```{r}
network_graph <- graph_from_adjacency_matrix(
  edge_matrix,
  mode = "undirected",
  weighted = TRUE
)

# Use qgraph to plot large graphs
edge_list_from_igraph <- get.edgelist(network_graph,names=FALSE)

qgraph_layout_modified <- qgraph.layout.fruchtermanreingold(edge_list_from_igraph,vcount=vcount(network_graph), area=8*(vcount(network_graph)^2),repulse.rad=(vcount(network_graph)^3.1))

plot(network_graph,layout=qgraph_layout_modified,vertex.size=4,vertex.label=NA)
mtext("Network graph based fruchtermanreingold layout", side=1)
```

# 4. Fundamenting patent-based concepts

**1. Innovation / Invention**

```{r}

```

**2. Novelty**

```{r}

```

**3. Knowledge assets and capabilities**

```{r}

```

**4. Innovation impact**

```{r}

```

**5. Relatedness**

```{r}

```

**6. Diversity**

```{r}

```

**7. Technological environment**

```{r}

```

**8. Learning**

```{r}

```

**9. Knowledge flows**

The transfer or spillover of knowledge, information, and/or skills from one entity to another (e.g., Mudambi & Navarra, 2004; Roach & Cohen, 2013)

...for example, Alvarez-Garrido and Dushnitsky (2016) measure innovativeness of biotechnology firms using both patents and scientific publications, and Roach and Cohen (2013) use publication coauthorship between academics and industrial R&D personnel instead of patent citations to measure knowledge flow.

- industrial
- academic
- private

```{r}
evaluate_knowledge_flow_type <- function(x){
  industrial <- "_INC_|INC_|LLC_|_LLC_|_CORP_|_CORPORATION_"
  academic <- "UNIV_|_UNIV_|INST_|_INST_"
  if(grepl(industrial, x)){
    return("industrial")
  }else{
    if(grepl(academic, x)){
      return("academic")
    }else{
      return("private")
    }
  }
}

edge_list$group <- NA

for (i in 1:nrow(edge_list)){
  row <- edge_list[i,]
  edge_list[i,"group"] <- evaluate_knowledge_flow_type(row$Applicants)
}

knowledge_flows_df <- data.frame(from=edge_list$Inventors.x, to=edge_list$Inventors.y, group=edge_list$group)

kf_graph <- graph_from_data_frame(knowledge_flows_df, directed = FALSE)

data <- toVisNetworkData(kf_graph)

nodes_groups <- vector()

for (current_node in data$nodes$id){
  df_sub <- knowledge_flows_df[knowledge_flows_df$from == current_node, ]
  nodes_groups <- c(nodes_groups, names(which.max(table(df_sub$group)))) # max of group is indicator for final group
}

data$nodes$group <- nodes_groups 
vis_network <- visNetwork(nodes = data$nodes, edges = data$edges)

vis_network %>% 
  visEdges(arrows = list(to = list(enabled= FALSE))) %>%
  visGroups(groupname = "academic", color = "red") %>%
  visGroups(groupname = "industrial", color = "black") %>%
  visGroups(groupname = "private", color = "blue") %>%
  visClusteringByGroup(groups = c("academic", "industrial", "private"), label = "Group : ", shape = "ellipse", color = "blue", force = F) %>%
  visIgraphLayout(layout = "layout_nicely")
```

**10. Collaboration**

```{r}

```

# 4. Network analysis

**1. Positional analysis**

Centrality

Brokerage

**2. Dyadic analysis**

Strong or weak thies?

**3. Subgroup and whole network analysis**

Components, Cliques and Clusters

Centralization

Density

### apply rules

```{r}
inventors <- df_qc[1,]$Inventors

inventors_split <- strsplit(inventors, "\n")

inventors_split[[1]][1]
```



